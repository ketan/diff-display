Rewrite of an (unreleased) library by Marcel Molina Jr., who wrote this it 
probably back in 2004 or so.